# EnOS Streaming Analytics Overview

EnOS™ Streaming Analytics targets to meet the real-time data processing requirements of user devices and assets.

Powered by Apache Spark™ Streaming with Envision customization and optimization, the EnOS Streaming Analytics engine offers high scalability, high throughput, and high fault-tolerance.

The streaming analytics service provides unified templates and a GUI to enable developers to customize a real-time data processing pipeline by dragging and dropping the function modules.

## What Are Streaming Data?

Broadly speaking, the generation of data can be considered as a series of discrete events. When drawing these discrete events on a time axis, an event stream or data stream is formed. Streaming data consist of these endless event streams.

Both offline data and streaming data are normally sent as logs. Unlike traditional offline data, streaming data are generated continuously by a lot of data sources. However, the size of the streaming data is normally smaller than that of the offline data.

The common sources of streaming data can be the devices connected to a data center, the telemetry data of devices, and the log files generated by mobile or web applications.

## What Is Streaming Analytics?

In general, streaming analytics has the following characteristics:

**Real-time and unbounded data streaming**

The computation faced by the engine is real-time and streaming, and the data streams are subscribed and consumed by stream computing in chronological order.

Because data are generated continuously, the data streams are integrated to the streaming system continuously. For example, website access log is a type of streaming data, the log continuously records data as long as the website is online. Thus, the streaming data are always real-time and unbounded.

**Continuous and efficient computation**

The computation models of stream computing are "event triggered". The trigger is the unbounded streaming data mentioned in the above section. Once new streaming data are sent to the system, the system immediately initiates and performs a computation task. Therefore, the stream computing is a continuous process.

**Streaming and real-time data integration**

The result of stream computing triggered by streaming data is recorded directly into the destination data storage. For example, the data can be directly written into the relational database (RDS) for report rendering. Therefore, the computing results of the streaming data are continuously recorded into the target data storage.

  ## When Is Streaming Analytics Needed?

  Streaming analytics can be used for the following scenarios:

- Aggregating and calculating asset raw data

  In most business scenarios, you might need to filter the raw data received from devices, aggregate the data by certain algorithm, and save the aggregated data for further analysis.  

- Computation of device states

  In some business scenarios, you might need to obtain certain state parameters of a device to confirm its status. You might want to program under the following circumstances:


## Considerations for Streaming Analytics

The streaming analytics framework maintains the state of devices and sites internally. The information is updated in real time according to the telemetry data.

- The system updates both the measure point values and the device connection status to the latest state.
- The update frequency depends on the acquisition and upload frequency of the measure points.

If a device is not connected, it means that the measure point of the device is not updated.

## Key Concepts of EnOS Streaming Analytics

  The following concepts are used in designing a customized stream computing pipeline:

  -   **Window Size**: Apache Spark™ Streaming is a stream computing engine based on time windows (micro-batch model) and processes data at the specified window size (interval of batch size). Windowing is simply the notion of taking a data source and chopping it up along temporal boundaries into finite chunks for processing, which determines how often a stream computing task gets the data.
  -   **Point Calculator**: The abstraction of the raw data acquisition points and user-defined computation points.
  -   **Processing Strategy**: Unified window aggregation scheme for the data of the same device model, which consists of an input point, output point, threshold, interpolation strategy, algorithm, and window size. 

## Data Processing Flow of EnOS Streaming Analytics

The procedure of EnOS Streaming Analytics is as follows:

1. Processing of raw data

   Original measure point data are sent to Kafka through the EnOS connection layer. The messages received are analyzed by the stream computing process of measure points. Before processing, data are filtered by the specified threshold. Data exceeding the threshold will be processed by interpolation algorithm. 

2. Performing calculation

   In this step, data are computed by the defined algorithm in the processing strategy.

3. Output of computing

   The data from the streaming module flows into Redis and Kafka, and the downstream continues to subscribe all data from Kafka and record them to time series database (TSDB) and Hadoop distributed file system (HDFS). By default, data of the latest three months are reserved in TSDB to support real-time queries through the EnOS API, and the data in HDFS is used as the data source for offline data processing and further processing and analysis.
